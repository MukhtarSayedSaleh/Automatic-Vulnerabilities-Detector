using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using AutomatedVulnerabilityDetectorVersion2.Classes.DB;

namespace AutomatedVulnerabilityDetectorVersion2.Testing
{
    public partial class DB : Form
    {
        ProfilesManager profile = new ProfilesManager();
        PagesManager page = new PagesManager();
        ExploitsManager exploit = new ExploitsManager();

        public DB()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
           
            MessageBox.Show(profile.addProfile("Test2TTT", true, true, true,true).ToString());
            MessageBox.Show(profile.addProfile("Test2FFF", false, false, false,false).ToString());
        }

        private void button2_Click(object sender, EventArgs e)
        {
            MessageBox.Show(profile.editProfile("editedTest2TTT",false,false,false,true,"3").ToString());

        }

        private void button3_Click(object sender, EventArgs e)
        {
            MessageBox.Show(profile.deleteProfile("4").ToString());
        }

        private void button4_Click(object sender, EventArgs e)
        {
            //MessageBox.Show(page.addPage("http://www.a.com/nullpage.php","1",string.Empty).ToString());
            //MessageBox.Show(page.addPage("http://www.a.com/1.php", "1", "<html><body><tal;skdjalskjdlasjd><asdjhaskdhkahsd>adasd</body></html>").ToString());
            MessageBox.Show(page.addPage("EDITme", "1", "<html><body><tal;skdjalskjdlasjd><asdjhaskdhkahsd>adasd</body></html>").ToString());
            
        }

        private void button6_Click(object sender, EventArgs e)
        {
            MessageBox.Show(page.setHasXSSed(true, "editme").ToString());
            MessageBox.Show(page.setHasSQLInjection(true, "editme").ToString());
            MessageBox.Show(page.setHasRFIed(true,"editme").ToString());
            
           
        }

        private void button5_Click(object sender, EventArgs e)
        {
            MessageBox.Show(exploit.add("1","XSS","asasasas","a").ToString());
        }

        private void button8_Click(object sender, EventArgs e)
        {
            MessageBox.Show(Classes.Web.Utilities.compareTwoLinks("http://www.a.com/a.php?a=a&b=b","http://www.a.com/a.php?a=aa&b=b&c=c",true).ToString());
        }
    }
}
