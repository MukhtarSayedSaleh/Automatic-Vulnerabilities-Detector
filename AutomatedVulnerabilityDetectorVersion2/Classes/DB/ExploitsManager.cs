/*
 * page exploits manager Class
 * the main purpose of this class is to 
 * add,delete,update, and manage page exploits
 * in the database.
 * 
 *       Mukhtar Sayed Saleh
 *       Syria- Al_Boukamal
 *       mokhtar_ss@hotmail.com
 *       00963944467547   
 * 
 *   start date : 7-9-2010
 *   finish date : 7-9-2010
 *   testing start date : 7-9-2010
 *   testing finish date : 9-10-2010 // OK
 *   
 *   !!!Converted from SQL Server to Access on 18-12-2010 for the speed
 *   and portability issues!!!
 */


using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data.OleDb;
using System.Configuration;

namespace AutomatedVulnerabilityDetectorVersion2.Classes.DB
{
    class ExploitsManager : SharedDbVariables
    {
        private string myConnectionString = AVD2ConnectionString;

        /// <summary>
        /// add new page exploit
        /// </summary>
        public bool add(string profileID, string exploitType, string exploitUsage, string vulnerableField)
        {
            try
            {
                using (OleDbConnection con = new OleDbConnection(this.myConnectionString))
                {
                    con.Open();
                    using (OleDbCommand cmd = new OleDbCommand("INSERT INTO `exploit` (`profileID` ,`exploitType` ,`exploitUsage` ,`vulnerableField`) VALUES (?, ?, ?, ?)", con))
                    {
                        cmd.Parameters.AddWithValue("profileID", profileID);
                        cmd.Parameters.AddWithValue("exploitType", exploitType);
                        cmd.Parameters.AddWithValue("exploitUsage", exploitUsage);
                        cmd.Parameters.AddWithValue("vulnerableField", vulnerableField);
                        cmd.ExecuteNonQuery();
                        return true;
                    }
                }
            }
            catch (Exception)
            {
                return false;
            }
        }


    }
}
